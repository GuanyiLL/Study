# 总线

## 总线的概念

计算机系统的五大部件之间的互连方式有两种，一种是各部件之间使用单独的连线，称为分散连接；另一种是将各部件连到一组公共信息传输线上，称为总线连接。

双总线结构：

一组总线连接CPU和主存，称为存储总线(M 总线)；另一组用来建立CPU和各I/O设备之间交换信息的通道，称为输入/输出总线(I/O总线)。

倘若将CUP、主存和I/O设备(通过I/O接口)都挂到一组总线上，使形成单总线结构的计算机。

还有一种以存储器为中心的双总线结构，它是在单总线基础上又开辟出的一条CPU与主存之间的总线。这组总线速度高，只供主存与CPU之间传输信息。

## 总线的分类

按数据传送方式可分为并行传输总线和串行传输总线。在并行传输总线中，又可按传输数据宽度分为8位、16位、32位、64位等传输总线。若按总线的使用范围划分，则又有计算机总线，测控总线、网络通信总线等。下面按连接部件不同，介绍三类总线。

### 片内总线

片内总线是指芯片内部的总线，如在CPU芯片内部，寄存器与寄存器之间，寄存器与算逻单元ALU之间都由片内总线连接。

### 系统总线

系统总线是指CPU、主存、I/O设备各大不见之间的信息传输线。

按系统总线传输信息的不同，又可分为三类：数据总线、地址总线和控制总线。

* 数据总线

数据总线用来传输各功能部件之间的数据信息，它是双向传输总线，其位数与机器字长、存储字长有关，一般为8位、16位、32位。数据总线的位数称为数组总线的宽度，它是衡量系统性能的一个重要参数。如果数据总线的宽度为8位，指令字长为16位，那么，CPU在取指阶段必须两次访问主存。

* 地址总线

地址总线主要用来指出数据总线上的源数据或目的数据在主存单元的地址或I/O设备的地址。地址总线上的代码是用来指明CPU欲访问的存储单元或I/O端口的地址，由CPU输出，单向传输。地址总线的位数与存储单元的个数有关，如地址线为20根，则对应的存储单元个数为$2^20$。

* 控制总线

由于数据总线、地址总线都是被挂在总线上的所有部件共享的，如何使各部件能在不同时刻占有总线使用权，需依靠控制总线来完成，因此控制总线是用来发出各种控制信号的传输线。

### 通信总线

按传输方式分为两种：

1. 串行通信
2. 并行通信

串行通信是指数据在单条1位宽的传输线上，一位一位地按顺序分时传送。

并行通信是指数据在多条并行1位宽的传输线上，同时由源传送到目的地。

## 总线特性及性能指标

### 总线特性

从屋里角度看，总线由许多导线直接印制在电路板上，延伸到各个部件。
总线特性包括以下几项：

* 机械特性

机械特性是指总线在机械连接方式上的一些性能，如插头与插板的使用标准，他们的几何尺寸
形状、引脚的个数以及排列的顺序，插头处的可靠接触等。

* 电气特性

电气特性是指总线的每一组传输线上信号的传递方向和有效的电平范围。通产规定由CPU发出的信号称为输出信号，送入CPU的信号称为输入信号。

* 功能特性

功能特性是指总线中没根传输线的功能。

* 时间特性

时间特性是指总线中的任一根线在什么时间内有效。每条总线上的各种信号互相存在一种有效时序的关系。

### 总线性能指标

1. 总线宽度：通常指数据总线的根数，用bit表示，如8位、16位、32位、64位。
2. 总线带宽：总线带宽可以理解为总线的数据传输速率，即单位时间内总线上传输数据的位数，通常用每秒传输信息的字节数来衡量，单位可用MBps表示。
3. 时钟同步/异步：总线上的数据与时钟同步工作的总线称为同步总线，与时钟不同步工作的总线称为异步总线。
4. 总线复用：一条信号线上分时传送两种信号。
5. 信号线数：地址总线、数据总线和控制总线三种总线数的总和。
6. 总线控制方式：包括突发工作、自动配置、仲裁方式、逻辑方式、计数方式等。
7. 其他指标：如负载能力、电源电压、总线宽度能否扩展等。

### 总线标准

总线是在计算机系统模块化的发展过程中产生的，随着计算机应用领域的不断扩大，计算机系统中各类模块品种机器复杂，往往一种模块要配一种总线，很难再总线上更换、组合各类模块或设备。20世纪70年代，人们建立了总线标准。

所谓总线标准，可视为系统与各模块、模块与模块之间的一个互联的标准界面。

目前流行的总线分为以下几种：

* ISA总线

ISA(Industrial Standard Architecture)总线是IBM为了采用全16位的CPU而退出的，又称AT总线，它使用独立于CPU的总线时钟，因此CPU可以采用比总线频率更高的时钟，有利于CPU性能的提高。ISA总线时钟频率为8MHz，最大传输率为16MBps，数据线为16位，地址线为24位。

* EISA总线总线

EISA(Extended Industrial Standard Architecture)是一种在ISA基础上扩充开放的总线标准，与ISA可以完全兼容，从CPU中分离出了总线控制权，是一种具有智能化的总线，neng'zh吃多个总线主控器和突发方式的传输。EISA总线的时钟频率为8MHz，最大传输率可达33MBps，地址总线为32位，扩充DMA访问范围达$2^32$。

* VESA总线

VESA总线是由VESA(Video Electronic Standard Association,视频电子标准协会)提出的布局总线标准，又称为VL-BUS(Local BUS)总线。所谓局部总线，是指在系统外为两个以上模块提供的高速传输信息通道。VL-BUS是由CPU总线演化而来的，采用CPU的时钟频率达33MHz、数据线为32位，可通过扩展到64位，配有局部控制器，最大传输率达133MBps。

* PCI总线

随着图形用户接口(Graphical User Interface, GUI)和多媒体技术在PC系统中的广泛运用，ISA总线和EISA总线由于受带宽的限制，已不能适应系统工作的要求，称为整个系统的主要瓶颈。因此对总线提出了更高的性能要求，促使总线技术进一步发展。

1991年下半年，Intel公司首先提出PCI(Peripheral COmponent Interconnect, 外围不见互联)总线的概念，1992年6月22日推出PCI 1.0版，1995和1999年先后推出2.1和2.2版，主要特点如下

1. 高性能
2. 良好的兼容性
3. 支持即插即用
4. 支持多主设备能力
5. 具有与处理器和存储器子系统完全并行操作的能力
6. 提供数据地址奇偶校验功能，保证了数据的完整和准确
7. 支持两种电压标准
8. 可扩充性好
9. 软件兼容性好
10. 采用多路复用技术，减少了总线引脚个数

* AGP总线

针对处理三维数据，1996年7月Intel推出AGP(Accelerated Graphics Port, 加速图形端口)

* RS-232C总线

RS-232C(RS即Recommended Standard，232为标识号，C表示修改次数)由美国电子工业协会EIA(Electronic Industries Association)推荐的一种串行通信总线标准，应用于串行二进制交换的数据终端设备(DTE)和数据通信设备(DCE)之间的标准接口。

![img01](/img/SerialCommunication.jpg)

DTE(Data Terminal Equipment)是数据终端设备，他是产生二进制信号的数据源，也是接受信息的目的地，是由数据发生器活接收器或间距两者组成的设备，它可以是一台计算机。DCE(Data Communication Equipment)是数据通信设备，它实质是一个信号的匹配器，既能满足DTE的要求，又能使传输信号符合线路要求。它具有提供数据终端设备与通信线路之间通信的建立、维持和终止链接等功能，同时还执行信号变换与编码。DTE与DCE之间传输的是`0`或`1`的数据，通过RS-232C接口规定的各种控制信号，可实现两者之间的协调配合。

* USB总线

USB(Universal Serial Bus)通用串行总线基于通用连接技术，实现外设的简单快速连接，达到方便用户、降低成本、扩展PC外设范围的目的。主要特点为：

* 即插即用特征
* 具有很强的链接能力
* 数据传输率有两种
    1.普通无屏蔽双绞线，速度可达1.5Mbps
    2.带屏蔽双绞线，速度可达12Mbps
* 标准统一
* 连接电缆轻巧，电源体积缩小
* 生命力强

## 总线结构

### 单总线结构


