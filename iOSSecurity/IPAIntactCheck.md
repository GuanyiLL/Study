# 应用完整性检查

场景：在越狱手机中，直接替换资源文件，然后重新启动app，加载了被替换的资源，app没有警告。

通过网络调查，目前市面上的方法大致分为三种：

* 将app包中的CodeResources文件放到服务端，app启动时下载与本地bundle文件夹内的文件做比较
* 检测app的cryptid值来看是否加密
* 对比资源文件的md5值

第一种方法中提到的CodeResources文件是Xcode在对IPA包做签名时的产物。

![CodeResource](/img/codeResource.png)

该文件为plist文件，files中存储了资源文件在签名之后的加密值，最终以base64编码显示，但是解码之后得到的仍然是乱码，因此只能在打包后将此文件交给后端，app启动后通过网络请求下载该文件，然后与本地的文件做比较。

第二种办法，由于通过App Store上架的应用，苹果会对ipa包做数字加密处理，通过比较cryptid可以来判断该应用是否为App Store下载的应用，但是对于直接替换资源文件，不会对加密产生影响，因此该方法只能用于验证加密。

```c

 
```

第三种办法，则在编译期间，将